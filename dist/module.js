/*! For license information please see module.js.LICENSE.txt */
define(["react","@grafana/ui","@grafana/data","emotion","@grafana/runtime","rxjs"],(function(e,t,n,r,a,o){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=93)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t){e.exports=r},function(e,t,n){var r=n(19),a="object"==typeof self&&self&&self.Object===Object&&self,o=r||a||Function("return this")();e.exports=o},function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t,n){var r=n(10)(Object,"create");e.exports=r},function(e,t,n){var r=n(13);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},function(e,t,n){var r=n(75);e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},function(e,t,n){var r=n(35),a=n(42);e.exports=function(e,t){var n=a(e,t);return r(n)?n:void 0}},function(e,t,n){var r=n(12),a=n(37),o=n(38),s=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":s&&s in Object(e)?a(e):o(e)}},function(e,t,n){var r=n(4).Symbol;e.exports=r},function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},function(e,t,n){var r=n(18),a=n(20);e.exports=function(e){return null!=e&&a(e.length)&&!r(e)}},function(e,t){e.exports=a},function(e,t,n){var r=n(17),a=n(29),o=n(31);e.exports=function(e,t){return o(a(e,t,r),e+"")}},function(e,t){e.exports=function(e){return e}},function(e,t,n){var r=n(11),a=n(5);e.exports=function(e){if(!a(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},function(e,t,n){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(this,n(36))},function(e,t){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},function(e,t){var n=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&n.test(e))&&e>-1&&e%1==0&&e<t}},function(e,t,n){var r=n(48),a=n(6),o=Object.prototype,s=o.hasOwnProperty,i=o.propertyIsEnumerable,l=r(function(){return arguments}())?r:function(e){return a(e)&&s.call(e,"callee")&&!i.call(e,"callee")};e.exports=l},function(e,t){var n=Array.isArray;e.exports=n},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t){e.exports=function(e){return function(t){return e(t)}}},function(e,t){e.exports=o},function(e,t,n){var r=n(16),a=n(13),o=n(44),s=n(45),i=Object.prototype,l=i.hasOwnProperty,u=r((function(e,t){e=Object(e);var n=-1,r=t.length,u=r>2?t[2]:void 0;for(u&&o(t[0],t[1],u)&&(r=1);++n<r;)for(var c=t[n],p=s(c),d=-1,f=p.length;++d<f;){var h=p[d],m=e[h];(void 0===m||a(m,i[h])&&!l.call(e,h))&&(e[h]=c[h])}return e}));e.exports=u},function(e,t,n){var r=n(57),a=n(89),o=n(16),s=n(92),i=o((function(e,t){return s(e)?r(e,a(t,1,s,!0)):[]}));e.exports=i},function(e,t,n){var r=n(30),a=Math.max;e.exports=function(e,t,n){return t=a(void 0===t?e.length-1:t,0),function(){for(var o=arguments,s=-1,i=a(o.length-t,0),l=Array(i);++s<i;)l[s]=o[t+s];s=-1;for(var u=Array(t+1);++s<t;)u[s]=o[s];return u[t]=n(l),r(e,this,u)}}},function(e,t){e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},function(e,t,n){var r=n(32),a=n(43)(r);e.exports=a},function(e,t,n){var r=n(33),a=n(34),o=n(17),s=a?function(e,t){return a(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:o;e.exports=s},function(e,t){e.exports=function(e){return function(){return e}}},function(e,t,n){var r=n(10),a=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=a},function(e,t,n){var r=n(18),a=n(39),o=n(5),s=n(41),i=/^\[object .+?Constructor\]$/,l=Function.prototype,u=Object.prototype,c=l.toString,p=u.hasOwnProperty,d=RegExp("^"+c.call(p).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!o(e)||a(e))&&(r(e)?d:i).test(s(e))}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var r=n(12),a=Object.prototype,o=a.hasOwnProperty,s=a.toString,i=r?r.toStringTag:void 0;e.exports=function(e){var t=o.call(e,i),n=e[i];try{e[i]=void 0;var r=!0}catch(e){}var a=s.call(e);return r&&(t?e[i]=n:delete e[i]),a}},function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},function(e,t,n){var r,a=n(40),o=(r=/[^.]+$/.exec(a&&a.keys&&a.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";e.exports=function(e){return!!o&&o in e}},function(e,t,n){var r=n(4)["__core-js_shared__"];e.exports=r},function(e,t){var n=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},function(e,t){var n=Date.now;e.exports=function(e){var t=0,r=0;return function(){var a=n(),o=16-(a-r);if(r=a,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},function(e,t,n){var r=n(13),a=n(14),o=n(21),s=n(5);e.exports=function(e,t,n){if(!s(n))return!1;var i=typeof t;return!!("number"==i?a(n)&&o(t,n.length):"string"==i&&t in n)&&r(n[t],e)}},function(e,t,n){var r=n(46),a=n(54),o=n(14);e.exports=function(e){return o(e)?r(e,!0):a(e)}},function(e,t,n){var r=n(47),a=n(22),o=n(23),s=n(49),i=n(21),l=n(51),u=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=o(e),c=!n&&a(e),p=!n&&!c&&s(e),d=!n&&!c&&!p&&l(e),f=n||c||p||d,h=f?r(e.length,String):[],m=h.length;for(var v in e)!t&&!u.call(e,v)||f&&("length"==v||p&&("offset"==v||"parent"==v)||d&&("buffer"==v||"byteLength"==v||"byteOffset"==v)||i(v,m))||h.push(v);return h}},function(e,t){e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},function(e,t,n){var r=n(11),a=n(6);e.exports=function(e){return a(e)&&"[object Arguments]"==r(e)}},function(e,t,n){(function(e){var r=n(4),a=n(50),o=t&&!t.nodeType&&t,s=o&&"object"==typeof e&&e&&!e.nodeType&&e,i=s&&s.exports===o?r.Buffer:void 0,l=(i?i.isBuffer:void 0)||a;e.exports=l}).call(this,n(24)(e))},function(e,t){e.exports=function(){return!1}},function(e,t,n){var r=n(52),a=n(25),o=n(53),s=o&&o.isTypedArray,i=s?a(s):r;e.exports=i},function(e,t,n){var r=n(11),a=n(20),o=n(6),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,e.exports=function(e){return o(e)&&a(e.length)&&!!s[r(e)]}},function(e,t,n){(function(e){var r=n(19),a=t&&!t.nodeType&&t,o=a&&"object"==typeof e&&e&&!e.nodeType&&e,s=o&&o.exports===a&&r.process,i=function(){try{var e=o&&o.require&&o.require("util").types;return e||s&&s.binding&&s.binding("util")}catch(e){}}();e.exports=i}).call(this,n(24)(e))},function(e,t,n){var r=n(5),a=n(55),o=n(56),s=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return o(e);var t=a(e),n=[];for(var i in e)("constructor"!=i||!t&&s.call(e,i))&&n.push(i);return n}},function(e,t){var n=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},function(e,t){e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},function(e,t,n){var r=n(58),a=n(81),o=n(86),s=n(87),i=n(25),l=n(88);e.exports=function(e,t,n,u){var c=-1,p=a,d=!0,f=e.length,h=[],m=t.length;if(!f)return h;n&&(t=s(t,i(n))),u?(p=o,d=!1):t.length>=200&&(p=l,d=!1,t=new r(t));e:for(;++c<f;){var v=e[c],y=null==n?v:n(v);if(v=u||0!==v?v:0,d&&y==y){for(var g=m;g--;)if(t[g]===y)continue e;h.push(v)}else p(t,y,u)||h.push(v)}return h}},function(e,t,n){var r=n(59),a=n(79),o=n(80);function s(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r;++t<n;)this.add(e[t])}s.prototype.add=s.prototype.push=a,s.prototype.has=o,e.exports=s},function(e,t,n){var r=n(60),a=n(74),o=n(76),s=n(77),i=n(78);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=a,l.prototype.get=o,l.prototype.has=s,l.prototype.set=i,e.exports=l},function(e,t,n){var r=n(61),a=n(67),o=n(73);e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(o||a),string:new r}}},function(e,t,n){var r=n(62),a=n(63),o=n(64),s=n(65),i=n(66);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=a,l.prototype.get=o,l.prototype.has=s,l.prototype.set=i,e.exports=l},function(e,t,n){var r=n(7);e.exports=function(){this.__data__=r?r(null):{},this.size=0}},function(e,t){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},function(e,t,n){var r=n(7),a=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return a.call(t,e)?t[e]:void 0}},function(e,t,n){var r=n(7),a=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:a.call(t,e)}},function(e,t,n){var r=n(7);e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},function(e,t,n){var r=n(68),a=n(69),o=n(70),s=n(71),i=n(72);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=a,l.prototype.get=o,l.prototype.has=s,l.prototype.set=i,e.exports=l},function(e,t){e.exports=function(){this.__data__=[],this.size=0}},function(e,t,n){var r=n(8),a=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0)&&(n==t.length-1?t.pop():a.call(t,n,1),--this.size,!0)}},function(e,t,n){var r=n(8);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},function(e,t,n){var r=n(8);e.exports=function(e){return r(this.__data__,e)>-1}},function(e,t,n){var r=n(8);e.exports=function(e,t){var n=this.__data__,a=r(n,e);return a<0?(++this.size,n.push([e,t])):n[a][1]=t,this}},function(e,t,n){var r=n(10)(n(4),"Map");e.exports=r},function(e,t,n){var r=n(9);e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},function(e,t){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},function(e,t,n){var r=n(9);e.exports=function(e){return r(this,e).get(e)}},function(e,t,n){var r=n(9);e.exports=function(e){return r(this,e).has(e)}},function(e,t,n){var r=n(9);e.exports=function(e,t){var n=r(this,e),a=n.size;return n.set(e,t),this.size+=n.size==a?0:1,this}},function(e,t){e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},function(e,t){e.exports=function(e){return this.__data__.has(e)}},function(e,t,n){var r=n(82);e.exports=function(e,t){return!!(null==e?0:e.length)&&r(e,t,0)>-1}},function(e,t,n){var r=n(83),a=n(84),o=n(85);e.exports=function(e,t,n){return t==t?o(e,t,n):r(e,a,n)}},function(e,t){e.exports=function(e,t,n,r){for(var a=e.length,o=n+(r?1:-1);r?o--:++o<a;)if(t(e[o],o,e))return o;return-1}},function(e,t){e.exports=function(e){return e!=e}},function(e,t){e.exports=function(e,t,n){for(var r=n-1,a=e.length;++r<a;)if(e[r]===t)return r;return-1}},function(e,t){e.exports=function(e,t,n){for(var r=-1,a=null==e?0:e.length;++r<a;)if(n(t,e[r]))return!0;return!1}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,a=Array(r);++n<r;)a[n]=t(e[n],n,e);return a}},function(e,t){e.exports=function(e,t){return e.has(t)}},function(e,t,n){var r=n(90),a=n(91);e.exports=function e(t,n,o,s,i){var l=-1,u=t.length;for(o||(o=a),i||(i=[]);++l<u;){var c=t[l];n>0&&o(c)?n>1?e(c,n-1,o,s,i):r(i,c):s||(i[i.length]=c)}return i}},function(e,t){e.exports=function(e,t){for(var n=-1,r=t.length,a=e.length;++n<r;)e[a+n]=t[n];return e}},function(e,t,n){var r=n(12),a=n(22),o=n(23),s=r?r.isConcatSpreadable:void 0;e.exports=function(e){return o(e)||a(e)||!!(s&&e&&e[s])}},function(e,t,n){var r=n(14),a=n(6);e.exports=function(e){return a(e)&&r(e)}},function(e,t,n){"use strict";n.r(t);var r=n(2),a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function o(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var s=function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function i(e,t,n,r){return new(n||(n=Promise))((function(a,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function i(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,i)}l((r=r.apply(e,t||[])).next())}))}function l(e,t){var n,r,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(a=s.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){s.label=o[1];break}if(6===o[0]&&s.label<a[1]){s.label=a[1],a=o;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(o);break}a[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}}function u(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(a)throw a.error}}return s}function p(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(c(arguments[t]));return e}function d(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var f,h,m,v,y,g=n(15);function b(e){return(null==e?void 0:e.queryType)===f.ListAssociatedAssets}function E(e){return(null==e?void 0:e.queryType)===f.PropertyAggregate}function I(e){return"function"==typeof e}!function(e){e.ListAssetModels="ListAssetModels",e.ListAssets="ListAssets",e.ListAssociatedAssets="ListAssociatedAssets",e.DescribeAsset="DescribeAsset",e.PropertyValue="PropertyValue",e.PropertyValueHistory="PropertyValueHistory",e.PropertyAggregate="PropertyAggregate"}(f||(f={})),function(e){e.ANY="ANY",e.GOOD="GOOD",e.BAD="BAD",e.UNCERTAIN="UNCERTAIN"}(h||(h={})),function(e){e.ASCENDING="ASCENDING",e.DESCENDING="DESCENDING"}(m||(m={})),function(e){e.Auto="AUTO",e.Min="1m",e.Hour="1h",e.Day="1d"}(v||(v={})),function(e){e.AVERAGE="AVERAGE",e.COUNT="COUNT",e.MAXIMUM="MAXIMUM",e.MINIMUM="MINIMUM",e.SUM="SUM",e.STANDARD_DEVIATION="STANDARD_DEVIATION"}(y||(y={}));var A=!1,w={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){if(e);A=e},get useDeprecatedSynchronousErrorHandling(){return A}};function S(e){setTimeout((function(){throw e}),0)}var x={closed:!0,next:function(e){},error:function(e){if(w.useDeprecatedSynchronousErrorHandling)throw e;S(e)},complete:function(){}},_=function(){return Array.isArray||function(e){return e&&"number"==typeof e.length}}();var C=function(){function e(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),O=function(){function e(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}return e.prototype.unsubscribe=function(){var t;if(!this.closed){var n,r=this._parentOrParents,a=this._ctorUnsubscribe,o=this._unsubscribe,s=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,r instanceof e)r.remove(this);else if(null!==r)for(var i=0;i<r.length;++i){r[i].remove(this)}if(I(o)){a&&(this._unsubscribe=void 0);try{o.call(this)}catch(e){t=e instanceof C?N(e.errors):[e]}}if(_(s)){i=-1;for(var l=s.length;++i<l;){var u=s[i];if(null!==(n=u)&&"object"==typeof n)try{u.unsubscribe()}catch(e){t=t||[],e instanceof C?t=t.concat(N(e.errors)):t.push(e)}}}if(t)throw new C(t)}},e.prototype.add=function(t){var n=t;if(!t)return e.EMPTY;switch(typeof t){case"function":n=new e(t);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof e)){var r=n;(n=new e)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var a=n._parentOrParents;if(null===a)n._parentOrParents=this;else if(a instanceof e){if(a===this)return n;n._parentOrParents=[a,this]}else{if(-1!==a.indexOf(this))return n;a.push(this)}var o=this._subscriptions;return null===o?this._subscriptions=[n]:o.push(n),n},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}},e.EMPTY=function(e){return e.closed=!0,e}(new e),e}();function N(e){return e.reduce((function(e,t){return e.concat(t instanceof C?t.errors:t)}),[])}var P=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),D=function(e){function t(n,r,a){var o=e.call(this)||this;switch(o.syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=x;break;case 1:if(!n){o.destination=x;break}if("object"==typeof n){n instanceof t?(o.syncErrorThrowable=n.syncErrorThrowable,o.destination=n,n.add(o)):(o.syncErrorThrowable=!0,o.destination=new j(o,n));break}default:o.syncErrorThrowable=!0,o.destination=new j(o,n,r,a)}return o}return o(t,e),t.prototype[P]=function(){return this},t.create=function(e,n,r){var a=new t(e,n,r);return a.syncErrorThrowable=!1,a},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},t}(O),j=function(e){function t(t,n,r,a){var o,s=e.call(this)||this;s._parentSubscriber=t;var i=s;return I(n)?o=n:n&&(o=n.next,r=n.error,a=n.complete,n!==x&&(I((i=Object.create(n)).unsubscribe)&&s.add(i.unsubscribe.bind(i)),i.unsubscribe=s.unsubscribe.bind(s))),s._context=i,s._next=o,s._error=r,s._complete=a,s}return o(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;w.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,n=w.useDeprecatedSynchronousErrorHandling;if(this._error)n&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)n?(t.syncErrorValue=e,t.syncErrorThrown=!0):S(e),this.unsubscribe();else{if(this.unsubscribe(),n)throw e;S(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var n=function(){return e._complete.call(e._context)};w.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){if(this.unsubscribe(),w.useDeprecatedSynchronousErrorHandling)throw e;S(e)}},t.prototype.__tryOrSetError=function(e,t,n){if(!w.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,n)}catch(t){return w.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=t,e.syncErrorThrown=!0,!0):(S(t),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(D);function T(e,t){return function(n){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new L(e,t))}}var L=function(){function e(e,t){this.project=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new R(e,this.project,this.thisArg))},e}(),R=function(e){function t(t,n,r){var a=e.call(this,t)||this;return a.project=n,a.count=0,a.thisArg=r||a,a}return o(t,e),t.prototype._next=function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(D),M=function(){function e(e,t){this.ds=e,this.region=t,this.assetsById=new Map}return e.prototype.getAssetInfo=function(e){return i(this,void 0,Promise,(function(){var t,n=this;return l(this,(function(a){return(t=this.assetsById.get(e))?[2,Promise.resolve(t)]:[2,this.ds.runQuery({refId:"getAssetInfo",queryType:f.DescribeAsset,assetId:e,region:this.region},1e3).pipe(T((function(t){if(t.data.length){var a=new r.DataFrameView(t.data[0]);if(a&&a.length){var o=function(e){var t,n,r=JSON.parse(e.properties),a=JSON.parse(e.hierarchies);try{for(var o=u(r),i=o.next();!i.done;i=o.next()){var l=i.value;l.value=l.Id,l.label=l.Name,l.Unit&&(l.label+=" ("+l.Unit+")"),l.DataType&&(l.description=l.DataType,l.Alias&&(l.description+=" // "+l.Alias))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return s(s({},e),{properties:r,hierarchy:a.map((function(e){return{label:e.Name,value:e.Id}}))})}(a.get(0));return n.assetsById.set(e,o),o}}throw"asset not found"}))).toPromise()]}))}))},e.prototype.getAssetInfoSync=function(e){var t=this,n=this.assetsById.get(e);if(n)return n;try{i(t,void 0,void 0,(function(){return l(this,(function(t){switch(t.label){case 0:return[4,this.getAssetInfo(e)];case 1:return[2,t.sent()]}}))}))}catch(e){}return this.assetsById.get(e)},e.prototype.getModels=function(){return i(this,void 0,Promise,(function(){var e=this;return l(this,(function(t){return this.models?[2,Promise.resolve(this.models)]:[2,this.ds.runQuery({refId:"getModels",queryType:f.ListAssetModels,region:this.region}).pipe(T((function(t){if(t.data.length)return e.models=new r.DataFrameView(t.data[0]),e.models;throw"no models found"}))).toPromise()]}))}))},e.prototype.getAssetsOfType=function(e){return i(this,void 0,Promise,(function(){var t,n=this;return l(this,(function(a){return t={refId:"getAssetsOfType",queryType:f.ListAssets,filter:"ALL",modelId:e,region:this.region},[2,this.ds.runQuery(t,1e3).pipe(T((function(e){if(e.data.length)return n.topLevelAssets=new r.DataFrameView(e.data[0]),n.topLevelAssets;throw"no assets found"}))).toPromise()]}))}))},e.prototype.getAssociatedAssets=function(e,t){return i(this,void 0,Promise,(function(){var n;return l(this,(function(a){return n={queryType:f.ListAssociatedAssets,refId:"associatedAssets",assetId:e,hierarchyId:t,region:this.region},[2,this.ds.runQuery(n,1e3).pipe(T((function(e){if(e.data.length)return new r.DataFrameView(e.data[0]);throw"no asset hierarchy found"}))).toPromise()]}))}))},e.prototype.getTopLevelAssets=function(){return i(this,void 0,Promise,(function(){var e,t=this;return l(this,(function(n){return this.topLevelAssets?[2,Promise.resolve(this.topLevelAssets)]:(e={refId:"topLevelAssets",queryType:f.ListAssets,filter:"TOP_LEVEL",region:this.region},[2,this.ds.runQuery(e,1e3).pipe(T((function(e){if(e.data.length)return t.topLevelAssets=new r.DataFrameView(e.data[0]),t.topLevelAssets;throw"no assets found"}))).toPromise()])}))}))},e.prototype.getAssetPickerOptions=function(){return i(this,void 0,Promise,(function(){var e,t,n,r,a,o,s,i,c,p,d;return l(this,(function(l){switch(l.label){case 0:e=[],l.label=1;case 1:return l.trys.push([1,3,,4]),[4,this.getTopLevelAssets()];case 2:t=l.sent();try{for(n=u(t),r=n.next();!r.done;r=n.next())s=r.value,e.push({label:s.name,value:s.id,description:s.arn})}catch(e){i={error:e}}finally{try{r&&!r.done&&(c=n.return)&&c.call(n)}finally{if(i)throw i.error}}return[3,4];case 3:return l.sent(),[3,4];case 4:try{for(a=u(this.assetsById.values()),o=a.next();!o.done;o=a.next())s=o.value,e.push({label:s.name,value:s.id,description:s.arn})}catch(e){p={error:e}}finally{try{o&&!o.done&&(d=a.return)&&d.call(a)}finally{if(p)throw p.error}}return[2,e]}}))}))},e}();function F(e){var t,n,r=[];try{for(var a=u(e.toArray()),o=a.next();!o.done;o=a.next()){var i=o.value,l=JSON.parse(i.hierarchies);r.push(s(s({},i),{properties:[],hierarchy:l.map((function(e){return{label:e.Name,value:e.Id}}))}))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return r}var q=n(26);function k(e){var t,n,a=e.refId+"/"+e.fields.length;try{for(var o=u(e.fields),s=o.next();!s.done;s=o.next()){var i=s.value;a+="|"+i.name+":"+i.type,i.labels&&(a+=Object(r.formatLabels)(i.labels))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return a}var U,V=function(e){function t(t){var n=e.call(this,t)||this;return n.cache=new Map,n.annotations={},n.options=t.jsonData,n}return o(t,e),t.prototype.getCache=function(e){e&&"default"!==e||(e=this.options.defaultRegion||"");var t=this.cache.get(e);return t||(t=new M(this,e),this.cache.set(e,t)),t},t.prototype.filterQuery=function(e){return!!e.queryType&&((t=e.queryType)!==f.PropertyAggregate&&t!==f.PropertyValue&&t!==f.PropertyValueHistory||!(!e.assetId||!e.propertyId));var t},t.prototype.getQueryDisplayText=function(e){var t=this.getCache(e.region),n=e.queryType;if(e.assetId){var r=t.getAssetInfoSync(e.assetId);if(!r)return n+" / "+e.assetId;if(n+=" / "+r.name,e.propertyId&&r.properties){var a=r.properties.find((function(t){return t.Id===e.propertyId}));n+=a?" / "+a.Name:" / "+e.propertyId}}return n},t.prototype.applyTemplateVariables=function(e,t){var n=Object(g.getTemplateSrv)();return s(s({},e),{region:n.replace(e.region||"",t),assetId:n.replace(e.assetId||"",t),propertyId:n.replace(e.propertyId||"",t)})},t.prototype.runQuery=function(e,t){return this.query({targets:[e],requestId:"iot."+Q++,maxDataPoints:t})},t.prototype.query=function(t){var n,a,o=this;return n=t,a={getNextQueries:function(e){var n,r,a,o;if(null===(a=e.data)||void 0===a?void 0:a.length){var i=[],l=function(e){var n=null===(o=e.meta)||void 0===o?void 0:o.custom;if(n&&n.nextToken){var r=t.targets.find((function(t){return t.refId===e.refId}));r&&i.push(s(s({},r),{nextToken:n.nextToken}))}};try{for(var c=u(e.data),p=c.next();!p.done;p=c.next())l(p.value)}catch(e){n={error:e}}finally{try{p&&!p.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}if(i.length)return i}},query:function(t){return e.prototype.query.call(o,t)},process:function(e,t,n){return e.data?e.data=function(e,t){var n,a,o,i,l,c,p=new Map,d=[];try{for(var f=u(e),h=f.next();!h.done;h=f.next())if((S=h.value).length){var m=k(S);if(S instanceof r.MutableDataFrame)p.set(m,S),d.push(S);else{var v=new r.MutableDataFrame;v.meta=S.meta,v.name=S.name,v.refId=S.refId;try{for(var y=(o=void 0,u(S.fields)),g=y.next();!g.done;g=y.next()){for(var b=g.value,E=[],I=0;I<S.length;I++)E.push(b.values.get(I));v.addField(s(s({},b),{values:new r.ArrayVector(E)}))}}catch(e){o={error:e}}finally{try{g&&!g.done&&(i=y.return)&&i.call(y)}finally{if(o)throw o.error}}p.set(m,v),d.push(v)}}}catch(e){n={error:e}}finally{try{h&&!h.done&&(a=f.return)&&a.call(f)}finally{if(n)throw n.error}}try{for(var A=u(t),w=A.next();!w.done;w=A.next()){var S;if((S=w.value).length){m=k(S);var x=p.get(m);if(x)for(I=0;I<S.length;I++)for(var _=0;_<x.fields.length;_++)x.fields[_].values.add(S.fields[_].values.get(I));else d.push(S)}}}catch(e){l={error:e}}finally{try{w&&!w.done&&(c=A.return)&&c.call(A)}finally{if(l)throw l.error}}return d}(e.data,t):e.data=t,e.data},onCancel:function(e){}},new q.Observable((function(e){var t=void 0,o=void 0,i={fetchStartTime:Date.now(),fetchEndTime:void 0},l=r.LoadingState.Loading,u=1,c={next:function(o){i.fetchEndTime=Date.now(),(l=o.state)!==r.LoadingState.Error&&(t=a.getNextQueries(o),l=t?r.LoadingState.Streaming:r.LoadingState.Done);var u=a.process(i,o.data,!t);e.next(s(s({},o),{data:u,state:l,key:n.requestId}))},error:function(t){e.error(t)},complete:function(){o&&(o.unsubscribe(),o=void 0),t?(i.fetchEndTime=void 0,i.fetchStartTime=Date.now(),o=a.query(s(s({},n),{requestId:n.requestId+"."+ ++u,startTime:i.fetchStartTime,targets:t})).subscribe(c),t=void 0):e.complete()}};return o=a.query(n).subscribe(c),function(){t=void 0,c.complete(),i.fetchEndTime||a.onCancel(i)}}))},t}(g.DataSourceWithBackend),Q=1e3,G=n(0),H=n.n(G),B=n(1),z=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={index:0},t.renderInfo=function(e,t){var n,r,a=null===(n=e.meta)||void 0===n?void 0:n.custom;return a?H.a.createElement("div",{key:t},a.resolution&&H.a.createElement("div",null,H.a.createElement("h3",null,"Resolution"),H.a.createElement(B.Tag,{name:a.resolution,colorIndex:1}),H.a.createElement("br",null),H.a.createElement("br",null)),(null===(r=a.aggregates)||void 0===r?void 0:r.length)&&H.a.createElement("div",null,H.a.createElement("h3",null,"Aggregates"),a.aggregates.map((function(e){return H.a.createElement(H.a.Fragment,null,H.a.createElement(B.Tag,{name:e,key:e,colorIndex:1})," Â ")})))):null},t}return o(t,e),t.prototype.render=function(){var e=this,t=this.props.data;return t&&t.length?H.a.createElement("div",null,t.map((function(t,n){return e.renderInfo(t,n)}))):H.a.createElement("div",null,"No Data")},t}(G.PureComponent);!function(e){e.Keys="keys",e.Credentials="credentials",e.Default="default"}(U||(U={}));var W=[{label:"AWS SDK Default",value:U.Default},{label:"Access & secret key",value:U.Keys},{label:"Credentials file",value:U.Credentials}],K=["ap-east-1","ap-northeast-1","ap-northeast-2","ap-northeast-3","ap-south-1","ap-southeast-1","ap-southeast-2","ca-central-1","cn-north-1","cn-northwest-1","eu-central-1","eu-north-1","eu-west-1","eu-west-2","eu-west-3","me-south-1","sa-east-1","us-east-1","us-east-2","us-gov-east-1","us-gov-west-1","us-iso-east-1","us-isob-east-1","us-west-1","us-west-2","Edge"].map((function(e){return{value:e,label:e}})),J=B.LegacyForms.Select,$=B.LegacyForms.Input,Y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={regions:K},t}return o(t,e),t.prototype.render=function(){var e,t,n,a=this,o=this.state.regions,s=this.props.options,i=s.secureJsonData||{},l=s.jsonData,u=l.profile;void 0===u&&(u=s.database);var c=o.find((function(e){return e.value===l.defaultRegion}));return!c&&l.defaultRegion&&(c={value:l.defaultRegion,label:l.defaultRegion}),H.a.createElement(H.a.Fragment,null,H.a.createElement("h3",{className:"page-heading"},"Connection Details"),H.a.createElement("div",{className:"gf-form-group"},H.a.createElement("div",{className:"gf-form-inline"},H.a.createElement("div",{className:"gf-form"},H.a.createElement(B.InlineFormLabel,{className:"width-14",tooltip:"Specify which AWS credentials chain to use. AWS SDK Default is the recommended option for EKS, ECS, or if you've attached an IAM role to your EC2 instance."},"Authentication Provider"),H.a.createElement(J,{className:"width-30",value:W.find((function(e){return e.value===s.jsonData.authType}))||W[0],options:W,defaultValue:s.jsonData.authType,onChange:function(e){Object(r.onUpdateDatasourceJsonDataOptionSelect)(a.props,"authType")(e)}}))),"credentials"===s.jsonData.authType&&H.a.createElement("div",{className:"gf-form-inline"},H.a.createElement("div",{className:"gf-form"},H.a.createElement(B.InlineFormLabel,{className:"width-14",tooltip:"Credentials profile name, as specified in ~/.aws/credentials, leave blank for default."},"Credentials Profile Name"),H.a.createElement("div",{className:"width-30"},H.a.createElement($,{className:"width-30",placeholder:"default",value:u,onChange:Object(r.onUpdateDatasourceJsonDataOption)(this.props,"profile")})))),"keys"===s.jsonData.authType&&H.a.createElement("div",null,(null===(e=s.secureJsonFields)||void 0===e?void 0:e.accessKey)?H.a.createElement("div",{className:"gf-form-inline"},H.a.createElement("div",{className:"gf-form"},H.a.createElement(B.InlineFormLabel,{className:"width-14"},"Access Key ID"),H.a.createElement($,{className:"width-25",placeholder:"Configured",disabled:!0})),H.a.createElement("div",{className:"gf-form"},H.a.createElement("div",{className:"max-width-30 gf-form-inline"},H.a.createElement(B.Button,{variant:"secondary",type:"button",onClick:Object(r.onUpdateDatasourceResetOption)(this.props,"accessKey")},"Reset")))):H.a.createElement("div",{className:"gf-form-inline"},H.a.createElement("div",{className:"gf-form"},H.a.createElement(B.InlineFormLabel,{className:"width-14"},"Access Key ID"),H.a.createElement("div",{className:"width-30"},H.a.createElement($,{className:"width-30",value:i.accessKey||"",onChange:Object(r.onUpdateDatasourceSecureJsonDataOption)(this.props,"accessKey")})))),(null===(t=s.secureJsonFields)||void 0===t?void 0:t.secretKey)?H.a.createElement("div",{className:"gf-form-inline"},H.a.createElement("div",{className:"gf-form"},H.a.createElement(B.InlineFormLabel,{className:"width-14"},"Secret Access Key"),H.a.createElement($,{className:"width-25",placeholder:"Configured",disabled:!0})),H.a.createElement("div",{className:"gf-form"},H.a.createElement("div",{className:"max-width-30 gf-form-inline"},H.a.createElement(B.Button,{variant:"secondary",type:"button",onClick:Object(r.onUpdateDatasourceResetOption)(this.props,"secretKey")},"Reset")))):H.a.createElement("div",{className:"gf-form-inline"},H.a.createElement("div",{className:"gf-form"},H.a.createElement(B.InlineFormLabel,{className:"width-14"},"Secret Access Key"),H.a.createElement("div",{className:"width-30"},H.a.createElement($,{className:"width-30",value:i.secretKey||"",onChange:Object(r.onUpdateDatasourceSecureJsonDataOption)(this.props,"secretKey")}))))),H.a.createElement("div",{className:"gf-form-inline"},H.a.createElement("div",{className:"gf-form"},H.a.createElement(B.InlineFormLabel,{className:"width-14",tooltip:"Optionally, specify the ARN of a role to assume. Specifying a role here will ensure that the selected authentication provider is used to assume the specified role rather than using the credentials directly. Leave blank if you don't need to assume a role at all"},"Assume Role ARN"),H.a.createElement("div",{className:"width-30"},H.a.createElement($,{className:"width-30",placeholder:"arn:aws:iam:*",value:s.jsonData.assumeRoleArn||"",onChange:Object(r.onUpdateDatasourceJsonDataOption)(this.props,"assumeRoleArn")})))),H.a.createElement("div",{className:"gf-form-inline"},H.a.createElement("div",{className:"gf-form-inline"},H.a.createElement("div",{className:"gf-form"},H.a.createElement(B.InlineFormLabel,{className:"width-14",tooltip:"If you are assuming a role in another account, that has been created with an external ID, specify the external ID here."},"External ID"),H.a.createElement("div",{className:"width-30"},H.a.createElement($,{className:"width-30",placeholder:"External ID",value:s.jsonData.externalId||"",onChange:Object(r.onUpdateDatasourceJsonDataOption)(this.props,"externalId")}))))),H.a.createElement("div",{className:"gf-form-inline"},H.a.createElement("div",{className:"gf-form"},H.a.createElement(B.InlineFormLabel,{className:"width-14",tooltip:"Specify the region, such as for US West (Oregon) use ` us-west-2 ` as the region."},"Default Region"),H.a.createElement(J,{className:"width-30",value:c,options:o,defaultValue:s.jsonData.defaultRegion,onChange:Object(r.onUpdateDatasourceJsonDataOptionSelect)(this.props,"defaultRegion"),allowCustomValue:!0,formatCreateLabel:function(e){return"Region: "+e}}))),H.a.createElement("div",{className:"gf-form-inline"},H.a.createElement("div",{className:"gf-form"},H.a.createElement(B.InlineFormLabel,{className:"width-14",tooltip:"Optionally, specify a custom endpoint for the service"},"Endpoint"),H.a.createElement("div",{className:"width-30"},H.a.createElement($,{className:"width-30",placeholder:null!==(n=this.props.defaultEndpoint)&&void 0!==n?n:"https://{service}.{region}.amazonaws.com",value:s.jsonData.endpoint||"",onChange:Object(r.onUpdateDatasourceJsonDataOption)(this.props,"endpoint")}))))))},t}(G.PureComponent),X=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return o(t,e),t.prototype.render=function(){var e,t=this,n=this.props.options,a=n.jsonData,o=a.defaultRegion,i=a.endpoint;return H.a.createElement(H.a.Fragment,null,H.a.createElement("div",null,H.a.createElement(Y,s({},this.props)),"Edge"===o&&H.a.createElement("div",null,!i&&H.a.createElement(B.Alert,{title:"Edge region requires an explicit endpoint configured above",severity:"warning"}),H.a.createElement("div",{className:"gf-form-inline"},H.a.createElement("div",{className:"gf-form gf-form--v-stretch"},H.a.createElement("label",{className:"gf-form-label width-14"},"Certification")),(null===(e=n.secureJsonFields)||void 0===e?void 0:e.cert)?H.a.createElement("div",{className:"gf-form"},H.a.createElement("div",{className:"max-width-30 gf-form-inline"},H.a.createElement(B.Button,{variant:"secondary",type:"button",onClick:Object(r.onUpdateDatasourceResetOption)(this.props,"cert")},"Reset"))):H.a.createElement("div",{className:"gf-form gf-form--grow"},H.a.createElement("textarea",{rows:7,className:"gf-form-input gf-form-textarea width-30",onChange:function(e){Object(r.updateDatasourcePluginSecureJsonDataOption)(t.props,"cert",e.target.value)},placeholder:"Begins with -----BEGIN CERTIFICATE------",required:!0}))))))},t}(G.PureComponent),Z=n(27),ee=n.n(Z),te=[{label:"Get property value aggregates",value:f.PropertyAggregate,description:"Gets aggregated values for an asset property.",defaultQuery:{resolution:v.Auto,aggregates:[y.AVERAGE],timeOrdering:"ASCENDING"},helpURL:"https://docs.aws.amazon.com/iot-sitewise/latest/APIReference/API_GetAssetPropertyAggregates.html"},{label:"Get property value history",value:f.PropertyValueHistory,description:"Gets the history of an asset property's value.",defaultQuery:{timeOrdering:"ASCENDING"},helpURL:"https://docs.aws.amazon.com/iot-sitewise/latest/APIReference/API_GetAssetPropertyAggregates.html"},{label:"Get property value",value:f.PropertyValue,description:"Gets an asset property's current value.",defaultQuery:{},helpURL:"https://docs.aws.amazon.com/iot-sitewise/latest/APIReference/API_GetAssetPropertyAggregates.html"},{label:"List assets",value:f.ListAssets,description:"Retrieves a paginated list of asset summaries.",defaultQuery:{filter:"TOP_LEVEL"},helpURL:"https://docs.aws.amazon.com/iot-sitewise/latest/APIReference/API_GetAssetPropertyAggregates.html"},{label:"List asset models",value:f.ListAssetModels,description:"Retrieves this list of all asset models",defaultQuery:{},helpURL:"https://docs.aws.amazon.com/iot-sitewise/latest/APIReference/API_GetAssetPropertyAggregates.html"},{label:"List associated assets",value:f.ListAssociatedAssets,description:"Retrieves a paginated list of associated assets.",defaultQuery:{},helpURL:"https://docs.aws.amazon.com/iot-sitewise/latest/APIReference/API_ListAssociatedAssets.html"}];function ne(e,t){if(e.queryType===t.value)return e;var n=s(s(s({},t.defaultQuery),e),{queryType:t.value}),r=n;return b(n)&&(delete r.timeOrdering,delete r.filter,delete r.resolution,delete r.aggregates),n}function re(e,t){if((null==e?void 0:e.properties)&&t)return e.properties.find((function(e){return e.Id===t}))}function ae(e){return"STRING"===(null==e?void 0:e.DataType)?y.COUNT:y.AVERAGE}var oe,se,ie,le,ue=[{label:"Top Level",value:"TOP_LEVEL",description:"The list includes only top-level assets in the asset hierarchy tree"},{label:"All",value:"ALL",description:"The list includes all assets for a given asset model ID"}],ce=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={},t.onAssetModelIdChange=function(e){var n=t.props,r=n.onChange,a=n.query,o=n.onRunQuery;r(s(s({},a),{modelId:e.value})),o()},t.onFilterChange=function(e){var n=t.props,r=n.onChange,a=n.query,o=n.onRunQuery;r(s(s({},a),{filter:e.value})),o()},t}return o(t,e),t.prototype.componentDidMount=function(){return i(this,void 0,void 0,(function(){var e,t;return l(this,(function(n){switch(n.label){case 0:return e=this.props.query,[4,this.props.datasource.getCache(e.region).getModels()];case 1:return t=n.sent(),this.setState({models:t}),[2]}}))}))},t.prototype.render=function(){var e=this.props.query,t=this.state.models,n=t?t.map((function(e){return{value:e.id,label:e.name,description:e.description}})):[],r=n.find((function(t){return t.value===e.modelId}));return e.modelId&&!r&&(r={value:e.modelId,label:"Model ID: "+e.modelId,description:""}),H.a.createElement(H.a.Fragment,null,H.a.createElement("div",{className:"gf-form"},H.a.createElement(B.InlineField,{label:"Model ID",labelWidth:Le,grow:!0},H.a.createElement(B.Select,{isLoading:!t,options:n,value:r,onChange:this.onAssetModelIdChange,placeholder:"Select an asset model id",allowCustomValue:!0,isClearable:!0,isSearchable:!0,formatCreateLabel:function(e){return"Model ID: "+e},menuPlacement:"bottom"}))),H.a.createElement("div",{className:"gf-form"},H.a.createElement(B.InlineField,{label:"Filter",labelWidth:Le,grow:!0},H.a.createElement(B.Select,{options:ue,value:ue.find((function(t){return t.value===e.filter}))||ue[0],onChange:this.onFilterChange,placeholder:"Select a property",menuPlacement:"bottom"}))))},t}(G.PureComponent),pe=n(3),de=function(e){var t=e.logoUrl,n=e.title,r=e.description,a=e.labels,o=e.actions,s=e.onClick,i=e.ariaLabel,l=e.className,u=Object(pe.cx)("add-data-source-item",l);return H.a.createElement("div",{className:u,onClick:s,"aria-label":i},t&&H.a.createElement("img",{className:"add-data-source-item-logo",src:t}),H.a.createElement("div",{className:"add-data-source-item-text-wrapper"},H.a.createElement("span",{className:"add-data-source-item-text"},n),r&&H.a.createElement("span",{className:"add-data-source-item-desc"},r),a&&H.a.createElement("div",null,a)),o&&H.a.createElement("div",{className:"add-data-source-item-actions"},o))},fe=function(e){var t=e.asset,n=e.onInspect,r=e.onSelect;return H.a.createElement(de,{title:t.name,description:t.id,onClick:function(){return r(t.id)},actions:H.a.createElement(H.a.Fragment,null,n&&H.a.createElement(B.Button,{variant:"secondary",onClick:function(e){e.stopPropagation(),n(t.id)},icon:"folder"},"BROWSE"),H.a.createElement(B.Button,{variant:"primary",icon:"check"},"SELECT"))})},he=Object(B.stylesFactory)((function(e){return{container:Object(pe.css)(oe||(oe=d(["\n      width: 100%;\n      height: auto;\n    "],["\n      width: 100%;\n      height: auto;\n    "]))),listItem:Object(pe.css)(se||(se=d(["\n      ","\n    "],["\n      ","\n    "])),B.styleMixins.listItem(e))}})),me=function(e){var t=e.listInfo,n=e.assets,r=e.search,a=e.onSelect,o=e.onInspect,s=e.open,i=void 0===s||s,l=Object(B.useTheme)(),u=he(l),c=t?H.a.createElement(B.Label,{description:t.description},t.name):"",p=function(){if(!n)return H.a.createElement("div",{key:null==t?void 0:t.id},H.a.createElement(B.Spinner,null),"Loading assets...");if(!n.length)return H.a.createElement(H.a.Fragment,null);var e=r?r.toLowerCase():"",s=r?n.filter((function(t){return t.name.toLowerCase().indexOf(e)>=0})):n;return!s.length&&r?H.a.createElement("div",{key:null==t?void 0:t.id},"No assets match: ",r):H.a.createElement("div",{key:null==t?void 0:t.id},s.map((function(e){return H.a.createElement(fe,{asset:e,key:e.id,onInspect:o,onSelect:a})})))};return t?H.a.createElement("div",{className:u.container},H.a.createElement(B.CollapsableSection,{label:c,isOpen:i},p())):p()},ve=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={},t.onModelIdChange=function(e){return i(t,void 0,void 0,(function(){var t,n,r;return l(this,(function(a){switch(a.label){case 0:return(t=e.value)?[4,this.props.cache.getAssetsOfType(t)]:[3,2];case 1:return r=a.sent(),[3,3];case 2:r=void 0,a.label=3;case 3:return n=r,this.setState({modelId:t,assets:n}),[2]}}))}))},t.onAssetChanged=function(e){return i(t,void 0,void 0,(function(){return l(this,(function(t){return e&&this.props.onAssetChanged(e),[2]}))}))},t.onSearchChange=function(e){t.setState({search:e.currentTarget.value})},t}return o(t,e),t.prototype.componentDidMount=function(){var e,t;return i(this,void 0,void 0,(function(){var n,r,a,o,s,i;return l(this,(function(l){switch(l.label){case 0:return n=this.props,r=n.asset,a=n.cache,i={},[4,a.getModels()];case 1:return i.models=l.sent(),(o=i).modelId=null!==(e=null==r?void 0:r.model_id)&&void 0!==e?e:null===(t=o.models)||void 0===t?void 0:t.get(0).id,s=o,[4,a.getAssetsOfType(o.modelId)];case 2:return s.assets=l.sent(),this.setState(o),[2]}}))}))},t.prototype.render=function(){var e=this.state,t=e.models,n=e.assets,r=e.modelId,a=e.search;if(!t)return H.a.createElement("div",null,H.a.createElement(B.Spinner,null),"Loading models...");var o=t.map((function(e){return{value:e.id,label:e.name,description:e.description}})),s=o.find((function(e){return e.value===r}));return H.a.createElement(H.a.Fragment,null,H.a.createElement("div",{style:{height:"60vh"}},H.a.createElement("h4",null,"Model:"),H.a.createElement(B.Select,{options:o,value:s||{},onChange:this.onModelIdChange,backspaceRemovesValue:!0,isSearchable:!0,menuPlacement:"bottom"}),H.a.createElement("br",null),H.a.createElement("br",null),H.a.createElement("h4",null,"Assets:"),s&&n?H.a.createElement(H.a.Fragment,null,n.length>2&&H.a.createElement(H.a.Fragment,null,H.a.createElement(B.Input,{css:"",value:a,onChange:this.onSearchChange,placeholder:"search..."}),H.a.createElement("br",null)),H.a.createElement(me,{search:a,assets:n.toArray(),onSelect:this.onAssetChanged})):H.a.createElement(H.a.Fragment,null,H.a.createElement("p",null),H.a.createElement("h6",null,"No assets found."))))},t}(G.Component),ye=Object(B.stylesFactory)((function(e){return{container:Object(pe.css)(ie||(ie=d(["\n      width: 100%;\n      height: auto;\n      margin-top: 10px;\n    "],["\n      width: 100%;\n      height: auto;\n      margin-top: 10px;\n    "]))),listItem:Object(pe.css)(le||(le=d(["\n      ","\n    "],["\n      ","\n    "])),B.styleMixins.listItem(e))}})),ge=function(e){var t=e.asset,n=e.hierarchy,r=e.children,a=e.cache,o=e.search,s=e.onSelect,u=e.onInspect,p=c(Object(G.useState)(r),2),d=p[0],f=p[1],h=Object(B.useTheme)(),m=ye(h);return Object(G.useEffect)((function(){if(!r&&t&&a){i(void 0,void 0,void 0,(function(){var e;return l(this,(function(r){switch(r.label){case 0:return[4,a.getAssociatedAssets(t.id,n.id)];case 1:return e=r.sent(),f(e.toArray()),[2]}}))}))}}),[r,t,a,n.id]),H.a.createElement("div",{key:n.id,className:m.container},H.a.createElement(me,{search:o,assets:d,listInfo:{id:n.id,description:n.id,name:n.name},onSelect:s,onInspect:u}))},be=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={assets:[]},t.getParentInfo=function(e){return i(t,void 0,Promise,(function(){return l(this,(function(t){switch(t.label){case 0:return[4,this.props.cache.getAssociatedAssets(e)];case 1:return[2,F(t.sent())]}}))}))},t.onSetAssetId=function(e){return i(t,void 0,void 0,(function(){return l(this,(function(t){switch(t.label){case 0:return[4,this.setSelectedAssetInfo(e)];case 1:return t.sent(),[2]}}))}))},t.setSelectedAssetInfo=function(e){return i(t,void 0,void 0,(function(){var t,n,r,a;return l(this,(function(o){switch(o.label){case 0:return t=this.props.cache,e?(n=this.setState,r=[s({},this.state)],a={},[4,t.getAssetInfo(e)]):[3,4];case 1:return a.asset=o.sent(),[4,t.getAssetPickerOptions()];case 2:return a.assets=o.sent(),[4,this.getParentInfo(e)];case 3:n.apply(this,[s.apply(void 0,r.concat([(a.parents=o.sent(),a)]))]),o.label=4;case 4:return[2]}}))}))},t.onAssetChange=function(e){return i(t,void 0,void 0,(function(){return l(this,(function(t){switch(t.label){case 0:return[4,this.setSelectedAssetInfo(e.value)];case 1:return t.sent(),[2]}}))}))},t.onAssetSelected=function(e){return i(t,void 0,void 0,(function(){return l(this,(function(t){return e&&this.props.onAssetSelected(e),[2]}))}))},t.onSearchChange=function(e){t.setState({search:e.currentTarget.value})},t.renderHierarchies=function(){var e=t.state,n=e.asset,r=e.search;if(n)return n.hierarchy.length?H.a.createElement(H.a.Fragment,null,H.a.createElement("h5",null," Asset Hierarchies: "),H.a.createElement("div",{style:{height:"40vh",overflow:"auto"}},H.a.createElement(B.Input,{css:"",value:r,onChange:t.onSearchChange,placeholder:"search..."}),H.a.createElement("br",null),n.hierarchy.map((function(e){return H.a.createElement(ge,{key:e.value,hierarchy:{name:e.label,id:e.value},asset:n,search:r,cache:t.props.cache,onInspect:t.onSetAssetId,onSelect:t.onAssetSelected})})))):H.a.createElement("h6",null,"No hierarchies found for asset.")},t.renderParents=function(){var e=t.state.parents;return H.a.createElement(H.a.Fragment,null,H.a.createElement("h5",null," Parents: "),e?H.a.createElement(me,{listInfo:{id:"",name:"Show Parents",description:""},assets:e,onSelect:t.onAssetSelected,onInspect:t.onSetAssetId,open:!1}):H.a.createElement("h6",null,"No parents found."))},t}return o(t,e),t.prototype.componentDidMount=function(){return i(this,void 0,void 0,(function(){var e,t,n,r,a,o,i,u;return l(this,(function(l){switch(l.label){case 0:return e=this.props,t=e.asset,n=e.cache,t?[4,this.getParentInfo(t.id)]:[3,2];case 1:return a=l.sent(),[3,3];case 2:a=void 0,l.label=3;case 3:return r=a,i=[s({},this.state)],u={asset:t},[4,n.getAssetPickerOptions()];case 4:return o=s.apply(void 0,i.concat([(u.assets=l.sent(),u.parents=r,u)])),this.setState(o),[2]}}))}))},t.prototype.render=function(){var e=this,t=this.state,n=t.asset,r=t.assets,a=n?r.find((function(e){return e.value===n.id})):void 0;return!a&&n&&(a={label:n.name,value:n.id,description:n.arn}),H.a.createElement("div",{style:{height:"60vh"}},n?H.a.createElement(H.a.Fragment,null,H.a.createElement(this.renderParents,null),H.a.createElement("p",null),H.a.createElement("h5",null," Selected Asset: "),H.a.createElement(fe,{asset:n,onSelect:function(){return e.onAssetSelected(null==n?void 0:n.id)}})):H.a.createElement(B.Select,{options:r,value:a,onChange:this.onAssetChange,placeholder:"Select an asset",allowCustomValue:!0,isClearable:!0,isSearchable:!0,onCreateOption:this.onSetAssetId,formatCreateLabel:function(e){return"Asset ID: "+e},menuPlacement:"bottom"}),H.a.createElement("br",null),this.renderHierarchies())},t}(G.Component),Ee=function(){return H.a.createElement("div",{className:"modal-header-title"},H.a.createElement(B.Icon,{name:"folder-open",size:"lg"}),H.a.createElement("span",{className:"p-l-1"},"Asset Browser"))},Ie=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isOpen:!1,tab:"Hierarchy"},t.onSelectAsset=function(e){t.props.onAssetChanged(e),t.setState({isOpen:!1})},t}return o(t,e),t.prototype.componentDidMount=function(){return i(this,void 0,void 0,(function(){var e,t,n,r,a,o;return l(this,(function(s){switch(s.label){case 0:return e=this.props,t=e.assetId,n=e.region,r=this.props.datasource.getCache(n),t?[4,r.getAssetInfo(t)]:[3,2];case 1:return o=s.sent(),[3,3];case 2:o=void 0,s.label=3;case 3:return a=o,this.setState({cache:r,asset:a}),[2]}}))}))},t.prototype.componentDidUpdate=function(e){return i(this,void 0,void 0,(function(){var t,n,r,a,o,i;return l(this,(function(l){switch(l.label){case 0:return t=s({},this.state),n=!1,this.props.region!==e.region&&(n=!0,t.cache=this.props.datasource.getCache(this.props.region)),this.props.assetId===e.assetId?[3,4]:(r=this.state.cache,a=this.props.assetId,n=!0,o=t,a?[4,r.getAssetInfo(a)]:[3,2]);case 1:return i=l.sent(),[3,3];case 2:i=void 0,l.label=3;case 3:o.asset=i,l.label=4;case 4:return n&&this.setState(t),[2]}}))}))},t.prototype.renderBody=function(){var e=this.state,t=e.cache,n=e.tab,r=e.asset;if(!t)return H.a.createElement("div",null,H.a.createElement(B.Spinner,null),"Loading...");switch(n){case"Hierarchy":return H.a.createElement(be,{cache:t,asset:r,onAssetSelected:this.onSelectAsset});case"Modal":return H.a.createElement(ve,{cache:t,asset:r,onAssetChanged:this.onSelectAsset})}},t.prototype.render=function(){var e=this,t=this.state,n=t.isOpen,r=t.tab;return H.a.createElement(H.a.Fragment,null,H.a.createElement(B.Button,{variant:"secondary",size:"md",icon:"folder-open",onClick:function(t){return e.setState({isOpen:!0},(function(){}))}},"Explore"),H.a.createElement(B.Modal,{title:H.a.createElement(Ee,null),isOpen:n,onDismiss:function(){return e.setState({isOpen:!1})}},H.a.createElement("div",null,H.a.createElement("div",null,H.a.createElement(B.TabsBar,null,H.a.createElement(B.Tab,{css:!0,label:"Hierarchy",active:"Hierarchy"===r,onChangeTab:function(){return e.setState({tab:"Hierarchy"})}}),H.a.createElement(B.Tab,{css:!0,label:"By Model",active:"Modal"===r,onChangeTab:function(){return e.setState({tab:"Modal"})}})),H.a.createElement(B.TabContent,{style:{maxHeight:"90vh"}},H.a.createElement("div",null,this.renderBody()))))))},t}(G.Component),Ae=n(28),we=n.n(Ae),Se=function(e){return!0},xe=function(e){return"STRING"!==e.DataType},_e=new r.Registry((function(){return[{id:y.AVERAGE,name:"Average",isValid:xe},{id:y.COUNT,name:"Count",isValid:Se},{id:y.MAXIMUM,name:"Max",isValid:xe},{id:y.MINIMUM,name:"Min",isValid:xe},{id:y.SUM,name:"Sum",isValid:xe},{id:y.STANDARD_DEVIATION,name:"Stddev",description:"Standard Deviation",isValid:xe}]})),Ce=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.checkInput=function(){var e=t.props,n=e.stats,r=e.allowMultiple,a=e.defaultStat,o=e.onChange,s=_e.list(n);if(s.length!==n.length){var i=s.map((function(e){return e.id}));we()(n,i);o(s.map((function(e){return e.id})))}!r&&n.length>1&&o([n[0]]),a&&n.length<1&&o([a])},t.onSelectionChange=function(e){var n=t.props.onChange;Array.isArray(e)?n(e.map((function(e){return e.value}))):n(e&&e.value?[e.value]:[])},t}return o(t,e),t.prototype.componentDidMount=function(){this.checkInput()},t.prototype.componentDidUpdate=function(e){this.checkInput()},t.prototype.render=function(){var e=this.props,t=e.stats,n=e.allowMultiple,r=e.defaultStat,a=e.className,o=e.menuPlacement,s=e.assetPropInfo,i=_e.selectOptions(t);return s&&"STRING"===s.DataType&&(i.options=_e.list().filter((function(e){return e.isValid(s)}))),H.a.createElement(B.Select,{value:i.current,className:a,isClearable:!r,isMulti:n,isSearchable:!0,options:i.options,onChange:this.onSelectionChange,menuPlacement:o})},t.defaultProps={allowMultiple:!0},t}(G.PureComponent),Oe=[{value:h.ANY,label:"ANY"},{value:h.GOOD,label:"GOOD"},{value:h.BAD,label:"BAD"},{value:h.UNCERTAIN,label:"UNCERTAIN"}],Ne=[{value:m.ASCENDING,label:"ASCENDING"},{value:m.DESCENDING,label:"DESCENDING"}],Pe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onQualityChange=function(e){var n=t.props,r=n.onChange,a=n.query,o=n.onRunQuery;r(s(s({},a),{quality:e.value})),o()},t.onOrderChange=function(e){var n=t.props,r=n.onChange,a=n.query,o=n.onRunQuery;r(s(s({},a),{timeOrdering:e.value})),o()},t.onMaxPageAggregations=function(e){var n=t.props,r=n.onChange,a=n.query,o=n.onRunQuery;r(s(s({},a),{maxPageAggregations:+e.currentTarget.value})),o()},t}return o(t,e),t.prototype.render=function(){var e,t,n=this.props.query;return H.a.createElement(H.a.Fragment,null,H.a.createElement("div",{className:"gf-form"},H.a.createElement(B.InlineField,{label:"Quality",labelWidth:Le},H.a.createElement(B.Select,{width:20,options:Oe,value:null!==(e=Oe.find((function(e){return e.value===n.quality})))&&void 0!==e?e:Oe[0],onChange:this.onQualityChange,isSearchable:!0,menuPlacement:"bottom"})),H.a.createElement(B.InlineField,{label:"Time",labelWidth:8},H.a.createElement(B.Select,{options:Ne,value:null!==(t=Ne.find((function(e){return e.value===n.timeOrdering})))&&void 0!==t?t:Ne[0],onChange:this.onOrderChange,isSearchable:!0,menuPlacement:"bottom"}))))},t}(G.PureComponent),De=[{value:v.Auto,label:"Auto",description:"Pick a resolution based on the time window"},{value:v.Min,label:"Minute",description:"1 point every minute"},{value:v.Hour,label:"Hour",description:"1 point every hour"},{value:v.Day,label:"Day",description:"1 point every day"}],je=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={assets:[],loading:!0,openModal:!1},t.onAssetChange=function(e){var n=t.props,r=n.onChange,a=n.query,o=n.onRunQuery;r(s(s({},a),{assetId:e.value})),o()},t.onPropertyChange=function(e){var n=t.props,r=n.onChange,a=n.query,o=n.onRunQuery,i=s(s({},a),{propertyId:e.value});if(E(i)&&i.propertyId){var l=re(t.state.asset,i.propertyId);i.aggregates||(i.aggregates=[]),l&&(i.aggregates=i.aggregates.filter((function(e){return _e.get(e).isValid(l)}))),i.aggregates.length||(i.aggregates=[ae(l)])}r(i),o()},t.onSetAssetId=function(e){var n=t.props,r=n.onChange,a=n.query,o=n.onRunQuery;r(s(s({},a),{assetId:e})),o()},t.onSetPropertyId=function(e){var n=t.props,r=n.onChange,a=n.query,o=n.onRunQuery;r(s(s({},a),{propertyId:e})),o()},t.onSetHierarchyId=function(e){var n=t.props,r=n.onChange,a=n.query,o=n.onRunQuery;r(s(s({},a),{hierarchyId:e})),o()},t.onHierarchyIdChange=function(e){var n=t.props,r=n.onChange,a=n.query,o=n.onRunQuery,i=s({},a);b(i)&&(e.value&&e.value.length?i.hierarchyId=e.value:delete i.hierarchyId),r(i),o()},t.onAggregateChange=function(e){var n=t.props,r=n.onChange,a=n.query,o=n.onRunQuery;r(s(s({},a),{aggregates:e})),o()},t.onResolutionChange=function(e){var n=t.props,r=n.onChange,a=n.query,o=n.onRunQuery;r(s(s({},a),{resolution:e.value})),o()},t}return o(t,e),t.prototype.updateInfo=function(){return i(this,void 0,void 0,(function(){var e,t,n,r,a,o,s;return l(this,(function(i){switch(i.label){case 0:if(e=this.props,t=e.query,n=e.datasource,r={loading:!1},a=n.getCache(t.region),!(null==t?void 0:t.assetId))return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),o=r,[4,a.getAssetInfo(t.assetId)];case 2:return o.asset=i.sent(),[3,4];case 3:return i.sent(),r.property=void 0,[3,4];case 4:r.property=re(r.asset,t.propertyId),i.label=5;case 5:return i.trys.push([5,7,,8]),s=r,[4,a.getAssetPickerOptions()];case 6:return s.assets=i.sent(),[3,8];case 7:return i.sent(),[3,8];case 8:return this.setState(r),[2]}}))}))},t.prototype.componentDidMount=function(){return i(this,void 0,void 0,(function(){return l(this,(function(e){return this.updateInfo(),[2]}))}))},t.prototype.componentDidUpdate=function(e){var t,n,r;return i(this,void 0,void 0,(function(){var a,o,s,i;return l(this,(function(l){return a=this.props.query,o=(null==a?void 0:a.assetId)!==(null===(t=null==e?void 0:e.query)||void 0===t?void 0:t.assetId),s=(null==a?void 0:a.propertyId)!==(null===(n=null==e?void 0:e.query)||void 0===n?void 0:n.propertyId),i=(null==a?void 0:a.region)!==(null===(r=null==e?void 0:e.query)||void 0===r?void 0:r.region),(o||s||i)&&(a.assetId||i?(this.setState({loading:!0}),this.updateInfo()):this.setState({asset:void 0,property:void 0,loading:!1})),[2]}))}))},t.prototype.renderAggregateRow=function(e){var t,n=this.state.property;return H.a.createElement("div",{className:"gf-form"},H.a.createElement(B.InlineField,{label:"Aggregate",labelWidth:Le,grow:!0},H.a.createElement(Ce,{stats:null!==(t=e.aggregates)&&void 0!==t?t:[],onChange:this.onAggregateChange,defaultStat:ae(n),menuPlacement:"bottom"})),H.a.createElement(B.InlineField,{label:"Resolution",labelWidth:10},H.a.createElement(B.Select,{width:18,options:De,value:De.find((function(t){return t.value===e.resolution}))||De[0],onChange:this.onResolutionChange,menuPlacement:"bottom"})))},t.prototype.renderAssociatedAsset=function(e){var t=this.state,n=t.asset,r=t.loading,a=[{value:"",label:"** Parent **"}];n&&a.push.apply(a,p(n.hierarchy));var o=a.find((function(t){return t.value===e.hierarchyId}));return o||(e.hierarchyId?(o={value:e.hierarchyId,label:"ID: "+e.hierarchyId},a.push(o)):o=a[0]),H.a.createElement("div",{className:"gf-form"},H.a.createElement(B.InlineField,{label:"Show",labelWidth:Le,grow:!0},H.a.createElement(B.Select,{isLoading:r,options:a,value:o,onChange:this.onHierarchyIdChange,placeholder:"Select...",allowCustomValue:!0,backspaceRemovesValue:!0,isClearable:!0,isSearchable:!0,onCreateOption:this.onSetHierarchyId,formatCreateLabel:function(e){return"Hierarchy Id: "+e},menuPlacement:"bottom"})))},t.prototype.render=function(){var e=this.props,t=e.query,n=e.datasource,r=this.state,a=r.loading,o=r.asset,i=r.assets,l=t.assetId?i.find((function(e){return e.value===t.assetId})):void 0;!l&&t.assetId&&(l=a?{label:"loading...",value:t.assetId}:o?{label:o.name,description:t.assetId,value:t.assetId}:{label:"ID: "+t.assetId,value:t.assetId});var u,c=b(t),p=!c&&(t.propertyId||t.assetId),d=p&&o?o.properties:[],h=t.propertyId&&E(t)||(null==(u=t)?void 0:u.queryType)===f.PropertyValueHistory,m=d.find((function(e){return e.Id===t.propertyId}));return!m&&t.propertyId&&(m={value:t.propertyId,label:"ID: "+t.propertyId}),H.a.createElement(H.a.Fragment,null,H.a.createElement("div",{className:"gf-form"},H.a.createElement(B.InlineField,{label:"Asset",labelWidth:Le,grow:!0},H.a.createElement(B.Select,{key:t.region?t.region:"default",isLoading:a,options:i,value:l,onChange:this.onAssetChange,placeholder:"Select an asset",allowCustomValue:!0,isClearable:!0,isSearchable:!0,onCreateOption:this.onSetAssetId,formatCreateLabel:function(e){return"Asset ID: "+e},menuPlacement:"bottom"})),H.a.createElement(Ie,{datasource:n,region:t.region,assetId:t.assetId,onAssetChanged:this.onSetAssetId})),p&&H.a.createElement(H.a.Fragment,null,H.a.createElement("div",{className:"gf-form"},H.a.createElement(B.InlineField,{label:"Property",labelWidth:Le,grow:!0},H.a.createElement(B.Select,{isLoading:a,options:d,value:m,onChange:this.onPropertyChange,placeholder:"Select a property",allowCustomValue:!0,isSearchable:!0,onCreateOption:this.onSetPropertyId,formatCreateLabel:function(e){return"Property ID: "+e},menuPlacement:"bottom"}))),h&&H.a.createElement(H.a.Fragment,null,E(t)&&this.renderAggregateRow(t),H.a.createElement(Pe,s({},this.props)))),c&&this.renderAssociatedAsset(t))},t}(G.PureComponent),Te={maxPageAggregations:1},Le=14,Re=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onQueryTypeChange=function(e){var n=t.props,r=n.onChange,a=n.query,o=n.onRunQuery;r(ne(a,e)),o()},t.onRegionChange=function(e){var n=t.props,r=n.onChange,a=n.query,o=n.onRunQuery;r(s(s({},a),{assetId:void 0,propertyId:void 0,region:e.value})),o()},t}return o(t,e),t.prototype.renderQuery=function(e){if(e.queryType){switch(e.queryType){case f.ListAssetModels:return null;case f.ListAssets:return H.a.createElement(ce,s({},this.props,{query:e}));case f.ListAssociatedAssets:case f.PropertyValue:case f.PropertyAggregate:case f.PropertyValueHistory:return H.a.createElement(je,s({},this.props))}return H.a.createElement("div",null,"Missing UI for query type: ",e.queryType)}},t.prototype.render=function(){var e,t=this.props.datasource,n=ee()(this.props.query,Te),r={label:"Default",desctiption:null===(e=t.options)||void 0===e?void 0:e.defaultRegion,value:void 0},a=n.region?p([r],K):K,o=te.find((function(e){return e.value===n.queryType})),s=o?H.a.createElement("div",null,o.description," ",H.a.createElement("br",null),H.a.createElement(B.LinkButton,{href:o.helpURL,target:"_blank"},"API Docs ",H.a.createElement(B.Icon,{name:"external-link-alt"}))):void 0;return H.a.createElement(H.a.Fragment,null,H.a.createElement("div",{className:"gf-form"},H.a.createElement(B.InlineField,{label:"Query type",labelWidth:14,grow:!0,tooltip:s},H.a.createElement(B.Select,{options:te,value:o,onChange:this.onQueryTypeChange,placeholder:"Select query type",menuPlacement:"bottom"})),H.a.createElement(B.InlineField,{label:"Region",labelWidth:14},H.a.createElement(B.Select,{width:18,options:a,value:K.find((function(e){return e.value===n.region}))||r,onChange:this.onRegionChange,backspaceRemovesValue:!0,allowCustomValue:!0,isClearable:!0,menuPlacement:"bottom"}))),this.renderQuery(n))},t}(G.PureComponent);n.d(t,"plugin",(function(){return Me}));var Me=new r.DataSourcePlugin(V).setConfigEditor(X).setMetadataInspector(z).setQueryEditor(Re)}])}));
//# sourceMappingURL=module.js.map